var documenterSearchIndex = {"docs":
[{"location":"api/core/#Core-Functions","page":"Core Functions","title":"Core Functions","text":"","category":"section"},{"location":"api/core/","page":"Core Functions","title":"Core Functions","text":"For more detailed documentation see the R package documentation (PDF). Note that function signatures and exposed functions are equivalent to the R version.","category":"page"},{"location":"api/core/#Bayesian-Methods","page":"Core Functions","title":"Bayesian Methods","text":"","category":"section"},{"location":"api/core/","page":"Core Functions","title":"Core Functions","text":"BayesianFM\nBayesianSDF\ncontinuous_ss_sdf\ncontinuous_ss_sdf_v2\ndirac_ss_sdf_pvalue","category":"page"},{"location":"api/core/#BayesianFactorZoo.BayesianFM","page":"Core Functions","title":"BayesianFactorZoo.BayesianFM","text":"BayesianFM(f::Matrix{Float64}, R::Matrix{Float64}, sim_length::Int)\n\nBayesian Fama-MacBeth regression. Similar to BayesianSDF but estimates factors' risk premia rather than risk prices.\n\nArguments\n\nf: Matrix of factors with dimension t times k, where k is the number of factors and t is the number of periods\nR: Matrix of test assets with dimension t times N, where t is the number of periods and N is the number of test assets\nsim_length: Length of MCMCs\n\nDetails\n\nUnlike BayesianSDF, we use factor loadings, beta_f, instead of covariance exposures, C_f, in the Fama-MacBeth regression. After obtaining posterior draws of mu_Y and Sigma_Y (see BayesianSDF), we calculate:\n\nReturns\n\nReturns a BayesianFMOutput struct containing:\n\nlambda_ols_path::Matrix{Float64}: Matrix of size simlength × (k+1) containing OLS risk premia estimates. First column is ``\\lambdac`` for constant term, next k columns are factor risk premia.\nlambda_gls_path::Matrix{Float64}: Matrix of size sim_length × (k+1) containing GLS risk premia estimates.\nR2_ols_path::Vector{Float64}: Vector of length sim_length containing OLS R^2 draws.\nR2_gls_path::Vector{Float64}: Vector of length sim_length containing GLS R^2 draws.\nMetadata fields accessible via dot notation:\nn_factors::Int: Number of factors (k)\nn_assets::Int: Number of test assets (N)\nn_observations::Int: Number of time periods (t)\nsim_length::Int: Number of MCMC iterations performed\n\nReferences\n\nBryzgalova S, Huang J, Julliard C (2023). \"Bayesian solutions for the factor zoo: We just ran two quadrillion models.\" Journal of Finance, 78(1), 487–557.\n\nExamples\n\n# Run Bayesian FM regression with 10,000 iterations  \nresults = BayesianFM(f, R, 10_000)\n\n# Access results\nols_risk_premia = mean(results.lambda_ols_path, dims=1)  # Mean OLS risk premia\ngls_r2 = mean(results.R2_gls_path)  # Mean GLS R²\n\n\n\n\n\n","category":"function"},{"location":"api/core/#BayesianFactorZoo.BayesianSDF","page":"Core Functions","title":"BayesianFactorZoo.BayesianSDF","text":"BayesianSDF(f::Matrix{Float64}, R::Matrix{Float64}, sim_length::Int=10000; \n           intercept::Bool=true, type::String=\"OLS\", prior::String=\"Flat\",\n           psi0::Float64=5.0, d::Float64=0.5)\n\nBayesian estimation of Linear SDF (B-SDF).\n\nArguments\n\nf: Matrix of factors with dimension t times k\nR: Matrix of test assets with dimension t times N\nsim_length: Length of MCMCs\nintercept: Include intercept if true, default=true\ntype: \"OLS\" or \"GLS\", default=\"OLS\"\nprior: \"Flat\" or \"Normal\", default=\"Flat\"\npsi0: Hyperparameter for normal prior, default=5\nd: Hyperparameter for normal prior, default=0.5\n\nReturns\n\nReturns a BayesianSDFOutput struct containing:\n\nlambda_path::Matrix{Float64}: Matrix of size simlength × (k+1) if intercept=true, or simlength × k if false. Contains posterior draws of risk prices.\nR2_path::Vector{Float64}: Vector of length sim_length containing R^2 draws.\nMetadata fields accessible via dot notation:\nn_factors::Int: Number of factors (k)\nn_assets::Int: Number of test assets (N)\nn_observations::Int: Number of time periods (t)\nsim_length::Int: Number of MCMC iterations performed\nprior::String: Prior specification used (\"Flat\" or \"Normal\")\nestimation_type::String: Estimation type used (\"OLS\" or \"GLS\")\n\nNotes\n\nInput matrices f and R must have the same number of rows (time periods)\nNumber of test assets (N) must be larger than number of factors (k) when including intercept\nNumber of test assets (N) must be >= number of factors (k) when excluding intercept\nThe function performs no pre-standardization of inputs\nRisk prices are estimated in the units of the input data (typically monthly returns)\n\nReferences\n\nBryzgalova S, Huang J, Julliard C (2023). \"Bayesian solutions for the factor zoo: We just ran two quadrillion models.\" Journal of Finance, 78(1), 487–557.\n\nExamples\n\n# Basic usage with default settings\nresults = BayesianSDF(f, R)\n\n# Use GLS with normal prior\nresults_gls = BayesianSDF(f, R, 10_000; \n                        type=\"GLS\", \n                        prior=\"Normal\",\n                        psi0=5.0,\n                        d=0.5)\n\n# Access results\nrisk_prices = mean(results.lambda_path, dims=1)\nr2_values = mean(results.R2_path)\n\n\n\n\n\n","category":"function"},{"location":"api/core/#BayesianFactorZoo.continuous_ss_sdf","page":"Core Functions","title":"BayesianFactorZoo.continuous_ss_sdf","text":"continuous_ss_sdf(f::Matrix{Float64}, R::Matrix{Float64}, sim_length::Int;\n                psi0::Float64=1.0, r::Float64=0.001,\n                aw::Float64=1.0, bw::Float64=1.0,\n                type::String=\"OLS\", intercept::Bool=true)\n\nSDF model selection using continuous spike-and-slab prior.\n\nArguments\n\nf: Matrix of factors with dimension t times k\nR: Matrix of test assets with dimension t times N\nsim_length: Length of MCMCs\npsi0: Hyperparameter in prior distribution of risk prices\nr: Hyperparameter for spike component (ll 1)\naw,bw: Beta prior parameters for factor inclusion probability\ntype: \"OLS\" or \"GLS\"\nintercept: Include intercept if true\n\nReturns\n\nReturns a ContinuousSSSDFOutput struct containing:\n\ngammapath::Matrix{Float64}: Matrix of size simlength × k containing posterior draws of factor inclusion indicators.\nlambdapath::Matrix{Float64}: Matrix of size simlength × (k+1) if intercept=true, or sim_length × k if false. Contains posterior draws of risk prices.\nsdfpath::Matrix{Float64}: Matrix of size simlength × t containing posterior draws of the SDF.\nbma_sdf::Vector{Float64}: Vector of length t containing the Bayesian Model Averaged SDF.\nMetadata fields accessible via dot notation:\nn_factors::Int: Number of factors (k)\nn_assets::Int: Number of test assets (N)\nn_observations::Int: Number of time periods (t)\nsim_length::Int: Number of MCMC iterations performed\n\nNotes\n\nInput matrices f and R must have the same number of rows (time periods)\nThe method automatically handles both traded and non-traded factors\nPrior parameters aw, bw control beliefs about model sparsity (default values favor no sparsity)\nParameter psi0 maps into prior beliefs about achievable Sharpe ratios\nThe spike component r should be close to zero to effectively shrink irrelevant factors\nThe resulting SDF is normalized to have mean 1\n\nReferences\n\nBryzgalova S, Huang J, Julliard C (2023). \"Bayesian solutions for the factor zoo: We just ran two quadrillion models.\" Journal of Finance, 78(1), 487–557.\n\nExamples\n\n# Basic usage with default settings\nresults = continuous_ss_sdf(f, R, 10_000)\n\n# Use GLS with modified priors for more aggressive selection\nresults_gls = continuous_ss_sdf(f, R, 10_000;\n                             type=\"GLS\",\n                             psi0=0.5,     # Tighter prior\n                             aw=1.0,       \n                             bw=9.0)       # Prior favoring sparsity\n\n# Access results\ninclusion_probs = mean(results.gamma_path, dims=1)  # Factor inclusion probabilities\nrisk_prices = mean(results.lambda_path, dims=1)     # Posterior mean risk prices\nsdf = results.bma_sdf                              # Model averaged SDF\n\n\n\n\n\n","category":"function"},{"location":"api/core/#BayesianFactorZoo.continuous_ss_sdf_v2","page":"Core Functions","title":"BayesianFactorZoo.continuous_ss_sdf_v2","text":"continuous_ss_sdf_v2(f1::Matrix{Float64}, f2::Matrix{Float64}, R::Matrix{Float64},\n                   sim_length::Int; psi0::Float64=1.0, r::Float64=0.001,\n                   aw::Float64=1.0, bw::Float64=1.0,\n                   type::String=\"OLS\", intercept::Bool=true)\n\nSDF model selection with continuous spike-and-slab prior, treating tradable factors as test assets.\n\nArguments\n\nf1: Matrix of nontradable factors with dimension t times k_1\nf2: Matrix of tradable factors with dimension t times k_2\nR: Matrix of test assets with dimension t times N (should NOT contain f2)\nsim_length: Length of MCMCs\npsi0,r,aw,bw,type,intercept: Same as continuoussssdf\n\nDetails\n\nSame prior structure and posterior distributions as continuoussssdf, but:\n\nTreats tradable factors f2 as test assets\nTotal dimension of test assets becomes N + k_2\nFactor loadings computed on combined test asset set\n\nReturns\n\nReturns a ContinuousSSSDFOutput struct containing:\n\ngamma_path::Matrix{Float64}: Matrix of size simlength × k containing posterior draws of factor inclusion indicators, where ``k = k1 + k_2`` (total number of factors).\nlambda_path::Matrix{Float64}: Matrix of size simlength × (k+1) if intercept=true, or simlength × k if false. Contains posterior draws of risk prices.\nsdf_path::Matrix{Float64}: Matrix of size sim_length × t containing posterior draws of the SDF.\nbma_sdf::Vector{Float64}: Vector of length t containing the Bayesian Model Averaged SDF.\nMetadata fields accessible via dot notation:\nn_factors::Int: Number of factors (k_1 + k_2)\nn_assets::Int: Number of test assets (N)\nn_observations::Int: Number of time periods (t)\nsim_length::Int: Number of MCMC iterations performed\n\nNotes\n\nInput matrices f1, f2, and R must have the same number of rows (time periods)\nTest assets R should not include the tradable factors f2\nThe factor selection combines both sparsity and density aspects through Bayesian Model Averaging\nPrior parameters aw, bw control beliefs about model sparsity\nParameter psi0 maps into prior beliefs about achievable Sharpe ratios\nThe spike component r should be close to zero to effectively shrink irrelevant factors\n\nReferences\n\nBryzgalova S, Huang J, Julliard C (2023). \"Bayesian solutions for the factor zoo: We just ran two quadrillion models.\" Journal of Finance, 78(1), 487–557.\n\nExamples\n\n# Basic usage with default settings\nresults = continuous_ss_sdf_v2(f1, f2, R, 10_000)\n\n# Use GLS with custom priors\nresults_gls = continuous_ss_sdf_v2(f1, f2, R, 10_000;\n                                type=\"GLS\",\n                                psi0=2.0,\n                                aw=2.0, \n                                bw=2.0)\n\n# Access results\ninclusion_probs = mean(results.gamma_path, dims=1)  # Factor inclusion probabilities\nrisk_prices = mean(results.lambda_path, dims=1)     # Risk price estimates\navg_sdf = results.bma_sdf                          # Model averaged SDF\n\n\n\n\n\n","category":"function"},{"location":"api/core/#BayesianFactorZoo.dirac_ss_sdf_pvalue","page":"Core Functions","title":"BayesianFactorZoo.dirac_ss_sdf_pvalue","text":"dirac_ss_sdf_pvalue(f::Matrix{Float64}, R::Matrix{Float64}, sim_length::Int,\n                  lambda0::Vector{Float64}; psi0::Float64=1.0,\n                  max_k::Union{Int,Nothing}=nothing)\n\nHypothesis testing for risk prices using Dirac spike-and-slab prior.\n\nArguments\n\nf: Matrix of factors with dimension t times k\nR: Matrix of test assets with dimension t times N\nsim_length: Length of MCMCs\nlambda0: k times 1 vector of null hypothesis values\npsi0: Hyperparameter in prior distribution\nmax_k: Maximum number of factors in models (optional)\n\nReturns\n\nReturns a DiracSSSDFOutput struct containing:\n\ngamma_path::Matrix{Float64}: Matrix of size sim_length × k containing posterior draws of factor inclusion indicators.\nlambda_path::Matrix{Float64}: Matrix of size sim_length × (k+1) containing posterior draws of risk prices.\nmodel_probs::Matrix{Float64}: Matrix of size M × (k+1) where M is the number of possible models. First k columns are model indices (0/1), last column contains model probabilities.\nMetadata fields accessible via dot notation:\nn_factors::Int: Number of factors (k)\nn_assets::Int: Number of test assets (N)\nn_observations::Int: Number of time periods (t)\nsim_length::Int: Number of MCMC iterations performed\n\nNotes\n\nInput matrices f and R must have the same number of rows (time periods)\nThe method is particularly useful for testing specific hypotheses about risk prices\nSetting max_k allows for focused testing of sparse models\nThe Dirac spike provides a more stringent test than the continuous spike-and-slab\nBayesian p-values can be constructed by integrating 1-p(γ|data)\nModel probabilities are properly normalized across the considered model space\n\nReferences\n\nBryzgalova S, Huang J, Julliard C (2023). \"Bayesian solutions for the factor zoo: We just ran two quadrillion models.\" Journal of Finance, 78(1), 487–557.\n\nExamples\n\n# Test if all risk prices are zero\nlambda0 = zeros(size(f, 2))\nresults = dirac_ss_sdf_pvalue(f, R, 10_000, lambda0)\n\n# Test specific values with max 3 factors\nlambda0_alt = [0.5, 0.3, -0.2, 0.1]\nresults_sparse = dirac_ss_sdf_pvalue(f, R, 10_000, lambda0_alt; max_k=3)\n\n# Access results\ninclusion_probs = mean(results.gamma_path, dims=1)  # Factor inclusion probabilities\nrisk_prices = mean(results.lambda_path, dims=1)     # Posterior mean risk prices\ntop_models = results.model_probs[sortperm(results.model_probs[:,end], rev=true)[1:10], :] # Top 10 models\n\n\n\n\n\n","category":"function"},{"location":"api/core/#Classical-Methods","page":"Core Functions","title":"Classical Methods","text":"","category":"section"},{"location":"api/core/","page":"Core Functions","title":"Core Functions","text":"SDF_gmm\nTwoPassRegression","category":"page"},{"location":"api/core/#BayesianFactorZoo.SDF_gmm","page":"Core Functions","title":"BayesianFactorZoo.SDF_gmm","text":"SDF_gmm(R::Matrix{Float64}, f::Matrix{Float64}, W::Matrix{Float64})\n\nGMM estimation of factor risk prices under linear SDF framework.\n\nArguments\n\nR: Matrix of test assets with dimension t times N\nf: Matrix of factors with dimension t times k\nW: Weighting matrix for GMM estimation, dimension (N+k) times (N+k)\n\nReturns\n\nReturns a SDFGMMOutput struct containing:\n\nlambda_gmm::Vector{Float64}: Vector of length k+1 containing risk price estimates (includes intercept).\nmu_f::Vector{Float64}: Vector of length k containing estimated factor means.\nAvar_hat::Matrix{Float64}: Matrix of size (2k+1) × (2k+1) containing asymptotic covariance matrix.\nR2_adj::Float64: Adjusted cross-sectional R^2.\nS_hat::Matrix{Float64}: Matrix of size (N+k) × (N+k) containing estimated spectral density matrix.\nMetadata fields accessible via dot notation:\nn_factors::Int: Number of factors (k)\nn_assets::Int: Number of test assets (N)\nn_observations::Int: Number of time periods (t)\n\nNotes\n\nInput matrices R and f must have the same number of rows (time periods)\nThe weighting matrix W should match dimensions (N+k) × (N+k)\nFor tradable factors, weighting matrix should impose self-pricing restrictions\nImplementation assumes no serial correlation in moment conditions\nR² is adjusted for degrees of freedom\nStandard errors are derived under the assumption of correct specification\n\nReferences\n\nBryzgalova S, Huang J, Julliard C (2023). \"Bayesian solutions for the factor zoo: We just ran two quadrillion models.\" Journal of Finance, 78(1), 487–557.\n\nHansen, Lars Peter (1982). \"Large Sample Properties of Generalized Method of Moments Estimators.\" Econometrica, 50(4), 1029-1054.\n\nExamples\n\n# Construct OLS weighting matrix\nW_ols = construct_weight_matrix(R, f, \"OLS\")\n\n# Perform OLS estimation\nresults_ols = SDF_gmm(R, f, W_ols)\n\n# Construct GLS weighting matrix\nW_gls = construct_weight_matrix(R, f, \"GLS\")\n\n# Perform GLS estimation\nresults_gls = SDF_gmm(R, f, W_gls)\n\n# Access results\nrisk_prices = results_ols.lambda_gmm[2:end]  # Factor risk prices (excluding intercept)\nstd_errors = sqrt.(diag(results_ols.Avar_hat)[2:end])  # Standard errors\nr_squared = results_ols.R2_adj  # Adjusted R²\n\nSee Also\n\nconstruct_weight_matrix: Function to construct appropriate OLS/GLS weighting matrices\nBayesianSDF: Bayesian alternative that is robust to weak factors\n\n\n\n\n\n","category":"function"},{"location":"api/core/#BayesianFactorZoo.TwoPassRegression","page":"Core Functions","title":"BayesianFactorZoo.TwoPassRegression","text":"TwoPassRegression(f::Matrix{Float64}, R::Matrix{Float64})\n\nClassical Fama-MacBeth two-pass regression.\n\nArguments\n\nf: Matrix of factors with dimension t times k\nR: Matrix of test assets with dimension t times N\n\nReturns\n\nReturns a TwoPassRegressionOutput struct containing:\n\nlambda::Vector{Float64}: Vector of length k+1 containing OLS risk premia estimates (includes intercept).\nlambda_gls::Vector{Float64}: Vector of length k+1 containing GLS risk premia estimates.\nt_stat::Vector{Float64}: Vector of length k+1 containing OLS t-statistics.\ntstatgls::Vector{Float64}: Vector of length k+1 containing GLS t-statistics.\nR2_adj::Float64: OLS adjusted R².\nR2adjGLS::Float64: GLS adjusted R².\nalpha::Vector{Float64}: Vector of length N containing OLS pricing errors.\nt_alpha::Vector{Float64}: Vector of length N containing t-statistics for OLS pricing errors.\nbeta::Matrix{Float64}: Matrix of size N × k containing factor loadings.\ncov_epsilon::Matrix{Float64}: Matrix of size N × N containing residual covariance.\ncov_lambda::Matrix{Float64}: Matrix of size (k+1) × (k+1) containing OLS covariance matrix of risk premia.\ncovlambdagls::Matrix{Float64}: Matrix of size (k+1) × (k+1) containing GLS covariance matrix of risk premia.\nR2_GLS::Float64: Unadjusted GLS R².\ncov_beta::Matrix{Float64}: Matrix of size (N(k+1)) × (N(k+1)) containing covariance matrix of beta estimates.\nMetadata fields accessible via dot notation:\nn_factors::Int: Number of factors (k)\nn_assets::Int: Number of test assets (N)\nn_observations::Int: Number of time periods (t)\n\nNotes\n\nInput matrices f and R must have the same number of rows (time periods)\nThe method is vulnerable to bias from weak and useless factors\nStandard errors account for the EIV problem but assume serial independence\nBoth OLS and GLS estimates are computed with appropriate standard errors\nR² values are adjusted for degrees of freedom\nIncludes corrections for using factors as test assets when applicable\n\nReferences\n\nFama, Eugene F., and James D. MacBeth, 1973, Risk, return, and equilibrium: Empirical tests, Journal of Political Economy 81, 607-636.\n\nShanken, Jay, 1992, On the estimation of beta-pricing models, Review of Financial Studies 5, 1-33.\n\nExamples\n\n# Perform two-pass regression\nresults = TwoPassRegression(f, R)\n\n# Access OLS results\nrisk_premia = results.lambda[2:end]  # Factor risk premia (excluding intercept)\nt_stats = results.t_stat[2:end]      # t-statistics\nr2_ols = results.R2_adj              # Adjusted R²\npricing_errors = results.alpha        # Pricing errors\n\n# Access GLS results\nrisk_premia_gls = results.lambda_gls[2:end]  \nt_stats_gls = results.t_stat_gls[2:end]\nr2_gls = results.R2_adj_GLS\n\n# First-pass results\nbetas = results.beta                  # Factor loadings\nstd_errors_beta = sqrt.(diag(results.cov_beta))  # Standard errors for betas\n\nSee Also\n\nBayesianFM: Bayesian version that is robust to weak factors\nSDF_gmm: GMM-based alternative estimation approach\n\n\n\n\n\n","category":"function"},{"location":"api/utils/#Utility-Functions","page":"Utility Functions","title":"Utility Functions","text":"","category":"section"},{"location":"api/utils/","page":"Utility Functions","title":"Utility Functions","text":"construct_weight_matrix\npsi_to_priorSR","category":"page"},{"location":"api/utils/#BayesianFactorZoo.construct_weight_matrix","page":"Utility Functions","title":"BayesianFactorZoo.construct_weight_matrix","text":"construct_weight_matrix(R::Matrix{Float64}, f::Matrix{Float64}, \n                     type::String=\"OLS\", kappa::Float64=1e6)\n\nConstruct weighting matrix for GMM estimation of linear SDF models.\n\nArguments\n\nR: Matrix of test assets with dimension t times N\nf: Matrix of factors with dimension t times k\ntype: \"OLS\" or \"GLS\", default=\"OLS\"\nkappa: Large constant for factor moment conditions, default=1e6\n\nDetails\n\nConstructs a (N+k) times (N+k) block diagonal weighting matrix W:\n\nW = beginbmatrix W_R  0_Ntimes k  0_ktimes N  kappa I_k endbmatrix\n\nwhere:\n\nOLS (type=\"OLS\"):\n\nW_R = I_N\n\nGLS (type=\"GLS\"):\n\nW_R = Sigma_R^-1\n\nThe structure reflects GMM moment conditions:\n\nEg_t(lambda_clambda_fmu_f) = E(R_t - lambda_c1_N - R_t(f_t - mu_f)lambda_f) (f_t - mu_f) = 0_N 0_k\n\nReturns\n\nReturns a Matrix{Float64} of size (N+k) times (N+k) containing the weighting matrix W with structure:\n\nUpper-left block: Identity (OLS) or inverse return covariance (GLS)\nLower-right block: kappa I_k\nOff-diagonal blocks: Zero matrices\n\nNote: The returned matrix matches the dimension requirements of SDF_gmm function\n\nNotes\n\nInput matrices R and f must have the same number of rows (time periods)\nThe GLS version requires a well-conditioned return covariance matrix\nκ should be large enough to ensure accurate factor mean estimation\nOutput matches dimensions required by SDF_gmm function\nBlock structure is optimal under conditional homoskedasticity\n\nReferences\n\nBryzgalova S, Huang J, Julliard C (2023). \"Bayesian solutions for the factor zoo: We just ran two quadrillion models.\" Journal of Finance, 78(1), 487–557.\n\nHansen, Lars Peter (1982). \"Large Sample Properties of Generalized Method of Moments Estimators.\" Econometrica, 50(4), 1029-1054.\n\nExamples\n\n# Construct OLS weighting matrix\nW_ols = construct_weight_matrix(R, f, \"OLS\")\n\n# Construct GLS weighting matrix\nW_gls = construct_weight_matrix(R, f, \"GLS\")\n\n# Use custom kappa value\nW_custom = construct_weight_matrix(R, f, \"OLS\", 1e8)\n\n# Use in GMM estimation\nresults_ols = SDF_gmm(R, f, W_ols)\nresults_gls = SDF_gmm(R, f, W_gls)\n\nSee Also\n\nSDF_gmm: Main function using these weighting matrices\n\n\n\n\n\n","category":"function"},{"location":"api/utils/#BayesianFactorZoo.psi_to_priorSR","page":"Utility Functions","title":"BayesianFactorZoo.psi_to_priorSR","text":"psi_to_priorSR(R::Matrix{Float64}, f::Matrix{Float64}; \n              psi0::Union{Nothing,Float64}=nothing,\n              priorSR::Union{Nothing,Float64}=nothing,\n              aw::Float64=1.0, bw::Float64=1.0)\n\nMap between prior tightness parameter psi and prior Sharpe ratio.\n\nArguments\n\nR: Matrix of test assets with dimension t times N\nf: Matrix of factors with dimension t times k\npsi0: Prior tightness parameter to convert to SR\npriorSR: Target SR to convert to psi0\naw,bw: Beta prior parameters\n\nReturns\n\nReturns a Float64 value either:\n\nThe implied prior Sharpe ratio if psi0 provided\nThe required psi0 value if priorSR provided\n\nNote: Returns error message string if neither or both arguments are provided\n\nNotes\n\nExactly one of psi0 or priorSR must be provided\nInput matrices R and f must have the same number of rows (time periods)\nThe mapping helps choose priors based on economic intuition about achievable Sharpe ratios\nDefault aw=bw=1 implies 50% prior probability of factor inclusion\nThe relationship is monotonic: higher ψ implies higher prior Sharpe ratio\nUseful for calibrating priors in continuoussssdf and continuoussssdf_v2\n\nReferences\n\nBryzgalova S, Huang J, Julliard C (2023). \"Bayesian solutions for the factor zoo: We just ran two quadrillion models.\" Journal of Finance, 78(1), 487–557.\n\nExamples\n\n# Load test data\n# Convert psi0 to implied prior Sharpe ratio\nimplied_sr = psi_to_priorSR(R, f; psi0=5.0)\nprintln(\"Psi0 = 5.0 implies prior SR = $implied_sr\")\n\n# Find psi0 needed for target Sharpe ratio\nrequired_psi = psi_to_priorSR(R, f; priorSR=0.5)\nprintln(\"For prior SR = 0.5, need psi0 = $required_psi\")\n\n# Use custom Beta prior parameters\npsi_sparse = psi_to_priorSR(R, f; \n                          priorSR=0.3,\n                          aw=1.0, \n                          bw=9.0)  # Prior favoring sparsity\n\n# Helper functions also available:\nusing BayesianFactorZoo: calculate_prior_SR, find_psi_for_target_SR\n\n# Get prior SR for a given psi\nsr = calculate_prior_SR(5.0, R, f)\n\n# Get psi for a target SR\npsi = find_psi_for_target_SR(0.5, R, f)\n\nSee Also\n\ncontinuous_ss_sdf: Main function using this prior calibration\ncontinuous_ss_sdf_v2: Version for tradable factors using this calibration\n\n\n\n\n\n","category":"function"},{"location":"#BayesianFactorZoo.jl","page":"Home","title":"BayesianFactorZoo.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"BayesianFactorZoo.jl is a Julia port of the R package 'BayesianFactorZoo' (CRAN link) implementing the econometric methods from the paper:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Bryzgalova, S., Huang, J., & Julliard, C. (2023). Bayesian solutions for the factor zoo: We just ran two quadrillion models. Journal of Finance, 78(1), 487–557. DOI: 10.1111/jofi.13197","category":"page"},{"location":"","page":"Home","title":"Home","text":"For a more detailed function documentations please see the documentation of the R package Link to PDF","category":"page"},{"location":"#Overview","page":"Home","title":"Overview","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"BayesianFactorZoo.jl provides a comprehensive framework for analyzing linear asset pricing models that is:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Simple and robust\nApplicable to high-dimensional problems\nCapable of handling both tradable and non-tradable factors","category":"page"},{"location":"","page":"Home","title":"Home","text":"For a stand-alone model, the package delivers reliable price of risk estimates for tradable and non-tradable factors.","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"For now this is not in the general registry (I will register it at some point). In the meantime you can install it directly from my repository.","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(\"http://github.com/eohne/BayesianFactorZoo.jl\")","category":"page"},{"location":"#Quick-Start","page":"Home","title":"Quick Start","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"using BayesianFactorZoo\n\n# Example with simulated data\nt, k, N = 600, 3, 25  # time periods, factors, assets\nf = randn(t, k)       # factor returns\nR = randn(t, N)       # asset returns\n\n# Perform Bayesian Fama-MacBeth regression\nresults_fm = BayesianFM(f, R, 10_000)\n\n# Estimate SDF with normal prior\nresults_sdf = BayesianSDF(f, R; prior=\"Normal\")\n\n# Model selection with continuous spike-and-slab\nresults_ss = continuous_ss_sdf(f, R, 10_000)","category":"page"},{"location":"#Features","page":"Home","title":"Features","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Bayesian Fama-MacBeth regression (BayesianFM)\nBayesian SDF estimation (BayesianSDF)\nModel selection via spike-and-slab priors (continuous_ss_sdf, continuous_ss_sdf_v2)\nHypothesis testing (dirac_ss_sdf_pvalue)\nGMM estimation (SDF_gmm)\nClassical two-pass regression (TwoPassRegression)","category":"page"},{"location":"#Citation","page":"Home","title":"Citation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"If you use this package, please cite:","category":"page"},{"location":"","page":"Home","title":"Home","text":"@article{bryzgalova2023bayesian,\n  title={Bayesian solutions for the factor zoo: We just ran two quadrillion models},\n  author={Bryzgalova, Svetlana and Huang, Jiantao and Julliard, Christian},\n  journal={The Journal of Finance},\n  volume={78},\n  number={1},\n  pages={487--557},\n  year={2023}\n}","category":"page"},{"location":"tutorial/#Examples-(from-R-Documentation)","page":"Tutorial","title":"Examples (from R Documentation)","text":"","category":"section"},{"location":"tutorial/#Set-Up","page":"Tutorial","title":"Set Up","text":"","category":"section"},{"location":"tutorial/#Load-Required-Packages","page":"Tutorial","title":"Load Required Packages","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"using BayesianFactorZoo\nusing RCall # to get the orignal example data\nusing DataFrames\nusing StatsPlots # Plotting\nusing Distributions\nusing Statistics\nusing StatsBase","category":"page"},{"location":"tutorial/#Load-Data-From-the-R-Package","page":"Tutorial","title":"Load Data From the R Package","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"R\"\"\"\nlibrary(BayesianFactorZoo)\ndata(\"BFactor_zoo_example\")\n\nHML = BFactor_zoo_example$\"HML\"\nlambda_ols = BFactor_zoo_example$\"lambda_ols\"\nR2_ols_true = BFactor_zoo_example$\"R2.ols.true\"\nsim_f = BFactor_zoo_example$\"sim_f\"\nsim_R = BFactor_zoo_example$\"sim_R\"\nuf = BFactor_zoo_example$\"uf\"\nW_ols = BFactor_zoo_example$\"W_ols\"\n\"\"\";\n\n# Extract all components\n\n# Get the data from R\n@rget HML lambda_ols R2_ols_true sim_f sim_R uf W_ols;","category":"page"},{"location":"tutorial/#Example-Bayesian-Fama-MacBeth","page":"Tutorial","title":"Example Bayesian Fama-MacBeth","text":"","category":"section"},{"location":"tutorial/#Case-1:-Strong-factor","page":"Tutorial","title":"Case 1: Strong factor","text":"","category":"section"},{"location":"tutorial/#Frequentist-Fama-MacBeth","page":"Tutorial","title":"Frequentist Fama-MacBeth","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"results_fm = TwoPassRegression(sim_f, sim_R)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Two-Pass Regression Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n\nOLS Risk Premia Estimates:\n  λ_0: 0.1672 (SE: 0.0293, t: 5.71)\n  λ_1: 0.1666 (SE: 0.0346, t: 4.82)\n\nGLS Risk Premia Estimates:\n  λ_0: 0.1238 (SE: 0.0267, t: 4.64)\n  λ_1: 0.1693 (SE: 0.0322, t: 5.25)\n\nModel Fit:\n  Adjusted R² (OLS): 0.5804\n  Adjusted R² (GLS): 0.8377\n","category":"page"},{"location":"tutorial/#Bayesian-Fama-MacBeth","page":"Tutorial","title":"Bayesian Fama-MacBeth","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"results_bfm = BayesianFM(sim_f, sim_R, 2000)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Ouput:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Bayesian Fama-MacBeth Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 2000\n\nRisk Premia Estimates (OLS):\n  λ_0: 0.1666 (±0.0294)\n  λ_1: 0.1657 (±0.0353)\n\nModel Fit:\n  Mean R² (OLS): 0.5298\n  Mean R² (GLS): 0.8108","category":"page"},{"location":"tutorial/#Extract-results-for-plotting","page":"Tutorial","title":"Extract results for plotting","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"k = 2;  # lambda of the strong factor\nm1 = results_fm.lambda[k];\nsd1 = sqrt(results_fm.cov_lambda[k,k]);","category":"page"},{"location":"tutorial/#Get-posterior-draws","page":"Tutorial","title":"Get posterior draws","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"bfm = results_bfm.lambda_ols_path[1001:2000,k];","category":"page"},{"location":"tutorial/#Generate-frequentist-draws","page":"Tutorial","title":"Generate frequentist draws","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"rng = MersenneTwister(123);  # for reproducibility\nfm = rand(rng, Normal(m1, sd1), 20000);","category":"page"},{"location":"tutorial/#Create-plotting-DataFrame","page":"Tutorial","title":"Create plotting DataFrame","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"df = DataFrame(\n    Value = vcat(fm, bfm),\n    Method = vcat(fill(\"Frequentist FM\", 20000), fill(\"Bayesian FM\", 1000))\n)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"21000×2 DataFrame\n   Row │ Value     Method\n       │ Float64   String\n───────┼──────────────────────────\n     1 │ 0.207803  Frequentist FM\n     2 │ 0.237487  Frequentist FM\n     3 │ 0.206156  Frequentist FM\n     4 │ 0.182515  Frequentist FM\n     5 │ 0.152894  Frequentist FM\n     6 │ 0.14362   Frequentist FM\n   ⋮   │    ⋮            ⋮\n 20996 │ 0.19532   Bayesian FM\n 20997 │ 0.130483  Bayesian FM\n 20998 │ 0.174461  Bayesian FM\n 20999 │ 0.226412  Bayesian FM\n 21000 │ 0.123783  Bayesian FM\n                20989 rows omitted","category":"page"},{"location":"tutorial/#Create-density-plot","page":"Tutorial","title":"Create density plot","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"p1 = @df df density(:Value, group=:Method, \n    linewidth=2,\n    xlabel=\"Risk premium (λstrong)\",\n    ylabel=\"Density\",\n    title=\"Strong Factor\"\n)\nvline!([lambda_ols[2]], linestyle=:dot, linewidth=1.5, color=:grey, label=\"\")","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: FM Strong Factor)","category":"page"},{"location":"tutorial/#Case-2:-Useless-factor","page":"Tutorial","title":"Case 2: Useless factor","text":"","category":"section"},{"location":"tutorial/#Repeat-the-process-with-useless-factor-(uf)","page":"Tutorial","title":"Repeat the process with useless factor (uf)","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"results_fm_uf = TwoPassRegression(uf, sim_R)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Two-Pass Regression Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n\nOLS Risk Premia Estimates:\n  λ_0: 0.1599 (SE: 0.0401, t: 3.99)\n  λ_1: 0.9540 (SE: 0.3578, t: 2.67)\n\nGLS Risk Premia Estimates:\n  λ_0: 0.1057 (SE: 0.0362, t: 2.93)\n  λ_1: -0.4335 (SE: 0.2760, t: -1.57)\n\nModel Fit:\n  Adjusted R² (OLS): -0.0075\n  Adjusted R² (GLS): -0.0125\n","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"results_bfm_uf = BayesianFM(uf, sim_R, 2000)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Bayesian Fama-MacBeth Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 2000\n\nRisk Premia Estimates (OLS):\n  λ_0: 0.1510 (±0.0417)\n  λ_1: 0.3079 (±0.9905)\n\nModel Fit:\n  Mean R² (OLS): 0.0842\n  Mean R² (GLS): 0.0013","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"m1_uf = results_fm_uf.lambda[k]\nsd1_uf = sqrt(results_fm_uf.cov_lambda[k,k])\nbfm_uf = results_bfm_uf.lambda_ols_path[1001:2000,k]\nfm_uf = rand(rng, Normal(m1_uf, sd1_uf), 20000)\ndf_uf = DataFrame(\n    Value = vcat(fm_uf, bfm_uf),\n    Method = vcat(fill(\"Frequentist FM\", 20000), fill(\"Bayesian FM\", 1000))\n)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"21000×2 DataFrame\n   Row │ Value      Method\n       │ Float64    String\n───────┼───────────────────────────\n     1 │  0.961224  Frequentist FM\n     2 │  1.10149   Frequentist FM\n     3 │  1.43786   Frequentist FM\n     4 │  1.35079   Frequentist FM\n     5 │  1.56759   Frequentist FM\n     6 │  1.21512   Frequentist FM\n   ⋮   │     ⋮            ⋮\n 20996 │ -1.26963   Bayesian FM\n 20997 │  0.669039  Bayesian FM\n 20998 │ -0.802147  Bayesian FM\n 20999 │  2.36535   Bayesian FM\n 21000 │ -0.601039  Bayesian FM\n                 20989 rows omitted","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"p2 = @df df_uf density(:Value, group=:Method, \n    linewidth=2,\n    xlabel=\"Risk premium (λspurious)\",\n    ylabel=\"Density\",\n    title=\"Useless Factor\"\n)\n\nvline!([lambda_ols[2]], linestyle=:dot, linewidth=1.5, color=:grey, label=\"\")","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: FM Spurious Factor)","category":"page"},{"location":"tutorial/#Display-plots-side-by-side","page":"Tutorial","title":"Display plots side by side","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"plot(p1, p2, layout=(1,2), size=(1200,400),bottom_margin=5Plots.mm)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: FM Both)","category":"page"},{"location":"tutorial/#Example-Bayesian-estimates-of-risk-prices-and-R2-(Bayesian-SDF)","page":"Tutorial","title":"Example Bayesian estimates of risk prices and R2 (Bayesian SDF)","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Cross-section: Fama-French 25 size and value portfolios  \nTrue pricing factor in simulations: HML  \nPseudo-true cross-sectional R-squared: 0.43  \nPseudo-true (monthly) risk price: 0.127  ","category":"page"},{"location":"tutorial/#Case-1:-Strong-factor-2","page":"Tutorial","title":"Case 1: Strong factor","text":"","category":"section"},{"location":"tutorial/#GMM-estimation","page":"Tutorial","title":"GMM estimation","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"sim_result = SDF_gmm(sim_R, sim_f, W_ols)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"SDF GMM Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n\nRisk Price Estimates:\n  λ_0: 0.1672\n  λ_1: 0.1666\n\nModel Fit:\n  Adjusted R²: 0.5804","category":"page"},{"location":"tutorial/#Bayesian-estimation","page":"Tutorial","title":"Bayesian estimation","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"two_step = BayesianSDF(sim_f, sim_R, 2000; psi0=5.0, d=0.5)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Bayesian SDF Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 2000\n  Prior type: Flat\n  Estimation type: OLS\n\nRisk Price Estimates:\n  λ_0: 0.1644 (±0.0291)\n  λ_1: 0.1634 (±0.0353)\n\nModel Fit:\n  Mean R²: 0.5287 (±0.1228)","category":"page"},{"location":"tutorial/#Extract-results-for-plotting-2","page":"Tutorial","title":"Extract results for plotting","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"k = 2  # lambda of the strong factor\nm1 = sim_result.lambda_gmm[k]\nsd1 = sqrt(sim_result.Avar_hat[k,k])\n\n# Get posterior draws\nbfm = two_step.lambda_path[1001:2000, k]\n\n# Generate GMM draws\nrng = MersenneTwister(123)  # for reproducibility\nfm = rand(rng, Normal(m1, sd1), 5000)\n\n# Create plotting DataFrame for strong factor\ndf_strong = DataFrame(\n    Value = vcat(fm, bfm),\n    Method = vcat(fill(\"GMM-OLS\", 5000), fill(\"BSDF-OLS\", 1000))\n)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"6000×2 DataFrame\n  Row │ Value     Method   \n      │ Float64   String\n──────┼────────────────────\n    1 │ 0.208319  GMM-OLS\n    2 │ 0.238374  GMM-OLS\n    3 │ 0.20665   GMM-OLS\n    4 │ 0.182714  GMM-OLS\n    5 │ 0.152722  GMM-OLS\n    6 │ 0.143332  GMM-OLS\n  ⋮   │    ⋮         ⋮\n 5996 │ 0.192677  BSDF-OLS\n 5997 │ 0.118785  BSDF-OLS\n 5998 │ 0.173055  BSDF-OLS\n 5999 │ 0.218479  BSDF-OLS\n 6000 │ 0.125678  BSDF-OLS\n          5989 rows omitted","category":"page"},{"location":"tutorial/#Create-density-plot-for-strong-factor","page":"Tutorial","title":"Create density plot for strong factor","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"p1 = @df df_strong density(:Value, group=:Method, \n    linewidth=2,\n    xlabel=\"Risk price (λstrong)\",\n    ylabel=\"Density\",\n    title=\"Strong Factor\",\n    adjust=1\n)\n\nvline!([lambda_ols[2]], linestyle=:dot, linewidth=1.5, color=:grey, label=\"\")","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: SDF Strong Factor)","category":"page"},{"location":"tutorial/#Case-2:-Useless-factor-2","page":"Tutorial","title":"Case 2: Useless factor","text":"","category":"section"},{"location":"tutorial/#GMM-estimation-2","page":"Tutorial","title":"GMM estimation","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"sim_result_uf = SDF_gmm(sim_R, uf, W_ols)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"SDF GMM Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n\nRisk Price Estimates:\n  λ_0: 0.1599\n  λ_1: 0.9540\n\nModel Fit:\n  Adjusted R²: -0.0075","category":"page"},{"location":"tutorial/#Bayesian-estimation-2","page":"Tutorial","title":"Bayesian estimation","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"two_step_uf = BayesianSDF(uf, sim_R, 2000; psi0=5.0, d=0.5)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Bayesian SDF Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 2000\n  Prior type: Flat\n  Estimation type: OLS\n\nRisk Price Estimates:\n  λ_0: 0.1490 (±0.0413)\n  λ_1: 0.3065 (±0.9778)\n\nModel Fit:\n  Mean R²: 0.0837 (±0.1400)","category":"page"},{"location":"tutorial/#Extract-results","page":"Tutorial","title":"Extract results","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"m1_uf = sim_result_uf.lambda_gmm[k]\nsd1_uf = sqrt(sim_result_uf.Avar_hat[k,k])\nbfm_uf = two_step_uf.lambda_path[1001:2000, k]\nfm_uf = rand(rng, Normal(m1_uf, sd1_uf), 5000)\n\n# Create plotting DataFrame for useless factor\ndf_useless = DataFrame(\n    Value = vcat(fm_uf, bfm_uf),\n    Method = vcat(fill(\"GMM-OLS\", 5000), fill(\"BSDF-OLS\", 1000))\n)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"6000×2 DataFrame\n  Row │ Value      Method   \n      │ Float64    String\n──────┼─────────────────────\n    1 │  0.564754  GMM-OLS\n    2 │  1.16776   GMM-OLS\n    3 │  1.38975   GMM-OLS\n    4 │  0.842655  GMM-OLS\n    5 │  0.901772  GMM-OLS\n    6 │  0.800888  GMM-OLS\n  ⋮   │     ⋮         ⋮\n 5996 │ -1.22358   BSDF-OLS\n 5997 │  0.646415  BSDF-OLS\n 5998 │ -0.808775  BSDF-OLS\n 5999 │  2.24012   BSDF-OLS\n 6000 │ -0.642434  BSDF-OLS\n           5989 rows omitted","category":"page"},{"location":"tutorial/#Create-density-plot-for-useless-factor","page":"Tutorial","title":"Create density plot for useless factor","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"p2 = @df df_useless density(:Value, group=:Method, \n    linewidth=2,\n    xlabel=\"Risk price (λspurious)\",\n    ylabel=\"Density\",\n    title=\"Useless Factor\",\n    adjust=2  # Note different adjustment for useless factor plot\n)\nvline!([0.0], linestyle=:dot, linewidth=1.5, color=:grey, label=\"\")","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: SDF Spurious Factor)","category":"page"},{"location":"tutorial/#Display-plots-side-by-side-2","page":"Tutorial","title":"Display plots side by side","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"plot(p1, p2, layout=(1,2), size=(1200,500),bottom_margin=5Plots.mm)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: SDF Both)","category":"page"},{"location":"tutorial/#Example-Continuous-SS-SDF","page":"Tutorial","title":"Example Continuous SS SDF","text":"","category":"section"},{"location":"tutorial/#Combine-factors-sim_f-and-uf","page":"Tutorial","title":"Combine factors sim_f and uf","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"combined_factors = hcat(sim_f, uf);","category":"page"},{"location":"tutorial/#Calculate-prior-SR-to-get-psi","page":"Tutorial","title":"Calculate prior SR to get psi","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"psi_hat = psi_to_priorSR(sim_R, combined_factors; priorSR=0.1);","category":"page"},{"location":"tutorial/#Run-continuous-spike-and-slab-SDF-estimation","page":"Tutorial","title":"Run continuous spike-and-slab SDF estimation","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"shrinkage = continuous_ss_sdf(combined_factors, sim_R, 5000;\n                            psi0=psi_hat, \n                            r=0.001, \n                            aw=1.0, \n                            bw=1.0)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Continuous Spike-and-Slab SDF Results:\n--------------------------------\nModel Information:\n  Number of factors: 2\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 5000\n\nFactor Inclusion Probabilities:\n  Factor 1: 0.9348\n  Factor 2: 0.5026\n\nRisk Price Estimates:\n  λ_0: 0.1586 (±0.0303)\n  λ_1: 0.1024 (±0.0451)\n  λ_2: -0.0000 (±0.0016)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Null hypothesis: lambda = 0 for each factor Posterior probabilities of rejecting the above null hypotheses are: [0.9348 0.5026]","category":"page"},{"location":"tutorial/#Get-SDF-paths","page":"Tutorial","title":"Get SDF paths","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"shrinkage.sdf_path","category":"page"},{"location":"tutorial/#Get-BMA-SDF","page":"Tutorial","title":"Get BMA-SDF","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"shrinkage.bma_sdf","category":"page"},{"location":"tutorial/#Example-Continuous-SS-SDF-v2-(tradable-factors)","page":"Tutorial","title":"Example Continuous SS SDF v2 (tradable factors)","text":"","category":"section"},{"location":"tutorial/#Example-1:-Using-first-test-asset","page":"Tutorial","title":"Example 1: Using first test asset","text":"","category":"section"},{"location":"tutorial/#Combine-factors-and-first-test-asset-for-psi-calculation","page":"Tutorial","title":"Combine factors and first test asset for psi calculation","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"combined_factors_1 = hcat(sim_f, uf, sim_R[:,1]);","category":"page"},{"location":"tutorial/#Calculate-psi_hat","page":"Tutorial","title":"Calculate psi_hat","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"psi_hat = psi_to_priorSR(sim_R, combined_factors_1; priorSR=0.1);","category":"page"},{"location":"tutorial/#Prepare-inputs-for-continuous*ss*sdf_v2","page":"Tutorial","title":"Prepare inputs for continuoussssdf_v2","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"f1 = hcat(sim_f, uf);          # non-tradable factors\nf2 = sim_R[:,1:1];             # tradable factor (first test asset)\nR_reduced = sim_R[:,2:end];    # remaining test assets","category":"page"},{"location":"tutorial/#Run-continuous-spike-and-slab-SDF-v2","page":"Tutorial","title":"Run continuous spike-and-slab SDF v2","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"shrinkage = continuous_ss_sdf_v2(f1, f2, R_reduced, 1000;\n                                psi0=psi_hat,\n                                r=0.001,\n                                aw=1.0,\n                                bw=1.0)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Continuous Spike-and-Slab SDF Results:\n--------------------------------\nModel Information:\n  Number of factors: 3\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 1000\n\nFactor Inclusion Probabilities:\n  Factor 1: 0.9240\n  Factor 2: 0.3820\n  Factor 3: 0.6680\n\nRisk Price Estimates:\n  λ_0: 0.1643 (±0.0344)\n  λ_1: 0.0881 (±0.0423)\n  λ_2: 0.0000 (±0.0013)\n  λ_3: -0.0077 (±0.0241)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Null hypothesis: lambda = 0 for each of these three factors   Posterior probabilities of rejecting the above null hypotheses are: [0.924 0.382 0.668]  ","category":"page"},{"location":"tutorial/#Calculate-model-implied-Sharpe-ratios","page":"Tutorial","title":"Calculate model-implied Sharpe ratios","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"sr_quantiles = quantile(std(shrinkage.sdf_path, dims=2), [0.05, 0.5, 0.95])\nprintln(\"The 5th, 50th, and 95th quantiles of model-implied Sharpe ratios: \", round.(sr_quantiles,digits=4))","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The 5th, 50th, and 95th quantiles of model-implied Sharpe ratios: [0.0267, 0.1092, 0.1723]","category":"page"},{"location":"tutorial/#Calculate-posterior-distribution-of-model-dimensions","page":"Tutorial","title":"Calculate posterior distribution of model dimensions","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"model_dims = sum(shrinkage.gamma_path, dims=2)\ndim_counts = counts(Int.(vec(model_dims)), 0:3)  # count occurrences of 0,1,2,3\ndim_props = dim_counts / sum(dim_counts)\nprintln(\"The posterior distribution of model dimensions (= 0, 1, 2, 3): \", dim_props)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The posterior distribution of model dimensions (= 0, 1, 2, 3): [0.015, 0.214, 0.553, 0.218]","category":"page"},{"location":"tutorial/#Optional:-Visualize-results","page":"Tutorial","title":"Optional: Visualize results","text":"","category":"section"},{"location":"tutorial/#Plot-posterior-distribution-of-model-dimensions","page":"Tutorial","title":"Plot posterior distribution of model dimensions","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"p1 = bar(0:3, dim_props,\n    xlabel=\"Model Dimension\",\n    ylabel=\"Probability\",\n    title=\"Posterior Distribution of Model Dimensions\",\n    label=\"\")","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: Model Dimension)","category":"page"},{"location":"tutorial/#Plot-SDF-paths","page":"Tutorial","title":"Plot SDF paths","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"p2 = plot(1:size(shrinkage.sdf_path,2), shrinkage.bma_sdf,\n    label=\"BMA-SDF\",\n    linewidth=2,\n    color=:black,\n    title=\"SDF Paths and BMA-SDF\");","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: BMA-SDF)","category":"page"},{"location":"tutorial/#Add-sample-paths","page":"Tutorial","title":"Add sample paths","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"function add_sample_paths!(p, shrinkage, n)\n    for i in 1:min(n, size(shrinkage.sdf_path,1))\n        plot!(p, 1:size(shrinkage.sdf_path,2), shrinkage.sdf_path[i,:],\n            alpha=0.1,\n            color=:blue,\n            label=\"\")\n    end\nend\nadd_sample_paths!(p2,shrinkage,50)\nplot(p1, p2, layout=(1,2), size=(1200,400))","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: Model Dimension BMA-SDF Path and Sample Paths)","category":"page"},{"location":"tutorial/#Example-Bayesian-p-value-(dirac*ss*sdf_pvalue)","page":"Tutorial","title":"Example Bayesian p-value (diracsssdf_pvalue)","text":"","category":"section"},{"location":"tutorial/#Choose-psi-based-on-prior-Sharpe-ratio","page":"Tutorial","title":"Choose psi based on prior Sharpe ratio","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"round4(x) = round(x,digits=4);\nprintln(\"If psi = 1, prior Sharpe ratio is \", \n        psi_to_priorSR(sim_R, sim_f; psi0=1.0) |> round4)\nprintln(\"If psi = 2, prior Sharpe ratio is \", \n        psi_to_priorSR(sim_R, sim_f; psi0=2.0) |> round4)\nprintln(\"If psi = 5, prior Sharpe ratio is \", \n        psi_to_priorSR(sim_R, sim_f; psi0=5.0) |> round4)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"If psi = 1, prior Sharpe ratio is 0.0724\nIf psi = 2, prior Sharpe ratio is 0.1014\nIf psi = 5, prior Sharpe ratio is 0.1559","category":"page"},{"location":"tutorial/#Test-whether-factors'-risk-prices-equal-lambda_ols[2]*std(HML)","page":"Tutorial","title":"Test whether factors' risk prices equal lambda_ols[2]*std(HML)","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"lambda0 = reshape([lambda_ols[2] * std(HML)], :, 1);\nshrinkage = dirac_ss_sdf_pvalue(sim_f, sim_R, 1000, vec(lambda0))","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Dirac Spike-and-Slab SDF Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 1000\n\nFactor Inclusion Probabilities:\n  Factor 1: 0.0150\n\nRisk Price Estimates:\n  λ_0: 0.1603 (±0.0293)\n  λ_1: 0.1256 (±0.0106)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Null hypothesis: lambda = 0.1269 Posterior probability of rejecting the above null hypothesis is: 0.015","category":"page"},{"location":"tutorial/#Test-whether-the-risk-price-of-factor-'sim_f'-is-equal-to-0","page":"Tutorial","title":"Test whether the risk price of factor 'sim_f' is equal to 0","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"shrinkage = dirac_ss_sdf_pvalue(sim_f, sim_R, 1000, [0.0]; psi0=1.0)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Dirac Spike-and-Slab SDF Results:\n--------------------------------\nModel Information:\n  Number of factors: 1\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 1000\n\nFactor Inclusion Probabilities:\n  Factor 1: 0.9510\n\nRisk Price Estimates:\n  λ_0: 0.1557 (±0.0295)\n  λ_1: 0.0787 (±0.0345)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Null hypothesis: lambda = 0 Posterior probability of rejecting the above null hypothesis is: 0.951","category":"page"},{"location":"tutorial/#Test-multiple-factors","page":"Tutorial","title":"Test multiple factors","text":"","category":"section"},{"location":"tutorial/#Combine-strong-and-useless-factors","page":"Tutorial","title":"Combine strong and useless factors","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"two_f = hcat(sim_f, uf);","category":"page"},{"location":"tutorial/#Test-both-factors'-risk-prices-equal-to-zero","page":"Tutorial","title":"Test both factors' risk prices equal to zero","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"lambda0_null_vec = zeros(2);  # 2x1 vector\nshrinkage = dirac_ss_sdf_pvalue(two_f, sim_R, 1000, lambda0_null_vec; psi0=1.0)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Dirac Spike-and-Slab SDF Results:\n--------------------------------\nModel Information:\n  Number of factors: 2\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 1000\n\nFactor Inclusion Probabilities:\n  Factor 1: 0.9640\n  Factor 2: 0.5040\n\nRisk Price Estimates:\n  λ_0: 0.1577 (±0.0302)\n  λ_1: 0.0796 (±0.0338)\n  λ_2: -0.0000 (±0.0010)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Null hypothesis: lambda = 0 for each factor Posterior probabilities of rejecting the above null hypothesis are 0.964 and 0.504","category":"page"},{"location":"tutorial/#Print-posterior-model-probabilities","page":"Tutorial","title":"Print posterior model probabilities","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"println(\"\\nPosterior model probabilities are:\")\ndisplay(shrinkage.model_probs)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Posterior model probabilities are:\n4×3 Matrix{Float64}:\n 0.0  0.0  0.019\n 1.0  0.0  0.477\n 0.0  1.0  0.017\n 1.0  1.0  0.487","category":"page"},{"location":"tutorial/#Test-with-maximum-number-of-factors-restriction","page":"Tutorial","title":"Test with maximum number of factors restriction","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"shrinkage = dirac_ss_sdf_pvalue(two_f, sim_R, 1000, lambda0_null_vec; \n                               psi0=1.0, max_k=1)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Dirac Spike-and-Slab SDF Results:\n--------------------------------\nModel Information:\n  Number of factors: 2\n  Number of assets: 25\n  Time periods: 1000\n  MCMC iterations: 1000\n\nFactor Inclusion Probabilities:\n  Factor 1: 0.9290\n  Factor 2: 0.0340\n\nRisk Price Estimates:\n  λ_0: 0.1574 (±0.0302)\n  λ_1: 0.0773 (±0.0360)\n  λ_2: 0.0000 (±0.0003)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"println(\"\\nPosterior model probabilities with max_k=1 are:\")\ndisplay(shrinkage.model_probs)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Console Output:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Posterior model probabilities with max_k=1 are:\n3×3 Matrix{Float64}:\n 0.0  0.0  0.037\n 1.0  0.0  0.929\n 0.0  1.0  0.034","category":"page"},{"location":"tutorial/#Visualize-posterior-probabilities","page":"Tutorial","title":"Visualize posterior probabilities","text":"","category":"section"},{"location":"tutorial/#Plot-posterior-probabilities-for-each-factor","page":"Tutorial","title":"Plot posterior probabilities for each factor","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"p1 = bar(mean(shrinkage.gamma_path, dims=1)',\n    title=\"Factor Inclusion Probabilities\",\n    xlabel=\"Factor\",\n    ylabel=\"Probability\",\n    label=\"\",\n    xticks=(1:2, [\"Strong\", \"Useless\"]))","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: Factor Inclusion Probabilities)","category":"page"},{"location":"tutorial/#Plot-model-probabilities","page":"Tutorial","title":"Plot model probabilities","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"p2 = bar(shrinkage.model_probs[:,end],\n    title=\"Model Posterior Probabilities\",\n    xlabel=\"Model Index\",\n    ylabel=\"Probability\",\n    label=\"\")\nplot(p1, p2, layout=(1,2), size=(1200,400),bottom_margin=5Plots.mm)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: Inc Prob and Model Post. Prob.)","category":"page"}]
}
