<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · BayesianFactorZoo.jl</title><meta name="title" content="Tutorial · BayesianFactorZoo.jl"/><meta property="og:title" content="Tutorial · BayesianFactorZoo.jl"/><meta property="twitter:title" content="Tutorial · BayesianFactorZoo.jl"/><meta name="description" content="Documentation for BayesianFactorZoo.jl."/><meta property="og:description" content="Documentation for BayesianFactorZoo.jl."/><meta property="twitter:description" content="Documentation for BayesianFactorZoo.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesianFactorZoo.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Set-Up"><span>Set Up</span></a></li><li><a class="tocitem" href="#Example-Bayesian-Fama-MacBeth"><span>Example Bayesian Fama-MacBeth</span></a></li><li><a class="tocitem" href="#Example-Bayesian-estimates-of-risk-prices-and-R2-(Bayesian-SDF)"><span>Example Bayesian estimates of risk prices and R2 (Bayesian SDF)</span></a></li><li><a class="tocitem" href="#Example-Continuous-SS-SDF"><span>Example Continuous SS SDF</span></a></li><li><a class="tocitem" href="#Example-Continuous-SS-SDF-v2-(tradable-factors)"><span>Example Continuous SS SDF v2 (tradable factors)</span></a></li><li><a class="tocitem" href="#Example-Bayesian-p-value-(dirac*ss*sdf_pvalue)"><span>Example Bayesian p-value (dirac<em>ss</em>sdf_pvalue)</span></a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api/core/">Core Functions</a></li><li><a class="tocitem" href="../api/utils/">Utility Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/eohne/BayesianFactorZoo.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/eohne/BayesianFactorZoo.jl/blob/main/docs/src/tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Examples-(from-R-Documentation)"><a class="docs-heading-anchor" href="#Examples-(from-R-Documentation)">Examples (from R Documentation)</a><a id="Examples-(from-R-Documentation)-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-(from-R-Documentation)" title="Permalink"></a></h1><h2 id="Set-Up"><a class="docs-heading-anchor" href="#Set-Up">Set Up</a><a id="Set-Up-1"></a><a class="docs-heading-anchor-permalink" href="#Set-Up" title="Permalink"></a></h2><h3 id="Load-Required-Packages"><a class="docs-heading-anchor" href="#Load-Required-Packages">Load Required Packages</a><a id="Load-Required-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Required-Packages" title="Permalink"></a></h3><pre><code class="language-julia hljs">using BayesianFactorZoo
using RCall # to get the orignal example data
using DataFrames
using StatsPlots # Plotting
using Distributions
using Statistics
using StatsBase</code></pre><h3 id="Load-Data-From-the-R-Package"><a class="docs-heading-anchor" href="#Load-Data-From-the-R-Package">Load Data From the R Package</a><a id="Load-Data-From-the-R-Package-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Data-From-the-R-Package" title="Permalink"></a></h3><pre><code class="language-julia hljs">R&quot;&quot;&quot;
library(BayesianFactorZoo)
data(&quot;BFactor_zoo_example&quot;)

HML = BFactor_zoo_example$&quot;HML&quot;
lambda_ols = BFactor_zoo_example$&quot;lambda_ols&quot;
R2_ols_true = BFactor_zoo_example$&quot;R2.ols.true&quot;
sim_f = BFactor_zoo_example$&quot;sim_f&quot;
sim_R = BFactor_zoo_example$&quot;sim_R&quot;
uf = BFactor_zoo_example$&quot;uf&quot;
W_ols = BFactor_zoo_example$&quot;W_ols&quot;
&quot;&quot;&quot;;

# Extract all components

# Get the data from R
@rget HML lambda_ols R2_ols_true sim_f sim_R uf W_ols;</code></pre><h2 id="Example-Bayesian-Fama-MacBeth"><a class="docs-heading-anchor" href="#Example-Bayesian-Fama-MacBeth">Example Bayesian Fama-MacBeth</a><a id="Example-Bayesian-Fama-MacBeth-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Bayesian-Fama-MacBeth" title="Permalink"></a></h2><h3 id="Case-1:-Strong-factor"><a class="docs-heading-anchor" href="#Case-1:-Strong-factor">Case 1: Strong factor</a><a id="Case-1:-Strong-factor-1"></a><a class="docs-heading-anchor-permalink" href="#Case-1:-Strong-factor" title="Permalink"></a></h3><h4 id="Frequentist-Fama-MacBeth"><a class="docs-heading-anchor" href="#Frequentist-Fama-MacBeth">Frequentist Fama-MacBeth</a><a id="Frequentist-Fama-MacBeth-1"></a><a class="docs-heading-anchor-permalink" href="#Frequentist-Fama-MacBeth" title="Permalink"></a></h4><pre><code class="language-julia hljs">results_fm = TwoPassRegression(sim_f, sim_R)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Two-Pass Regression Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000

OLS Risk Premia Estimates:
  λ_0: 0.1672 (SE: 0.0293, t: 5.71)
  λ_1: 0.1666 (SE: 0.0346, t: 4.82)

GLS Risk Premia Estimates:
  λ_0: 0.1238 (SE: 0.0267, t: 4.64)
  λ_1: 0.1693 (SE: 0.0322, t: 5.25)

Model Fit:
  Adjusted R² (OLS): 0.5804
  Adjusted R² (GLS): 0.8377
</code></pre><h4 id="Bayesian-Fama-MacBeth"><a class="docs-heading-anchor" href="#Bayesian-Fama-MacBeth">Bayesian Fama-MacBeth</a><a id="Bayesian-Fama-MacBeth-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Fama-MacBeth" title="Permalink"></a></h4><pre><code class="language-julia hljs">results_bfm = BayesianFM(sim_f, sim_R, 2000)</code></pre><p>Console Ouput:</p><pre><code class="language-juia hljs">Bayesian Fama-MacBeth Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 2000

Risk Premia Estimates (OLS):
  λ_0: 0.1666 (±0.0294)
  λ_1: 0.1657 (±0.0353)

Model Fit:
  Mean R² (OLS): 0.5298
  Mean R² (GLS): 0.8108</code></pre><h3 id="Extract-results-for-plotting"><a class="docs-heading-anchor" href="#Extract-results-for-plotting">Extract results for plotting</a><a id="Extract-results-for-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Extract-results-for-plotting" title="Permalink"></a></h3><pre><code class="language-julia hljs">k = 2;  # lambda of the strong factor
m1 = results_fm.lambda[k];
sd1 = sqrt(results_fm.cov_lambda[k,k]);</code></pre><h4 id="Get-posterior-draws"><a class="docs-heading-anchor" href="#Get-posterior-draws">Get posterior draws</a><a id="Get-posterior-draws-1"></a><a class="docs-heading-anchor-permalink" href="#Get-posterior-draws" title="Permalink"></a></h4><pre><code class="language-julia hljs">bfm = results_bfm.lambda_ols_path[1001:2000,k];</code></pre><h4 id="Generate-frequentist-draws"><a class="docs-heading-anchor" href="#Generate-frequentist-draws">Generate frequentist draws</a><a id="Generate-frequentist-draws-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-frequentist-draws" title="Permalink"></a></h4><pre><code class="language-julia hljs">rng = MersenneTwister(123);  # for reproducibility
fm = rand(rng, Normal(m1, sd1), 20000);</code></pre><h4 id="Create-plotting-DataFrame"><a class="docs-heading-anchor" href="#Create-plotting-DataFrame">Create plotting DataFrame</a><a id="Create-plotting-DataFrame-1"></a><a class="docs-heading-anchor-permalink" href="#Create-plotting-DataFrame" title="Permalink"></a></h4><pre><code class="language-julia hljs">df = DataFrame(
    Value = vcat(fm, bfm),
    Method = vcat(fill(&quot;Frequentist FM&quot;, 20000), fill(&quot;Bayesian FM&quot;, 1000))
)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">21000×2 DataFrame
   Row │ Value     Method
       │ Float64   String
───────┼──────────────────────────
     1 │ 0.207803  Frequentist FM
     2 │ 0.237487  Frequentist FM
     3 │ 0.206156  Frequentist FM
     4 │ 0.182515  Frequentist FM
     5 │ 0.152894  Frequentist FM
     6 │ 0.14362   Frequentist FM
   ⋮   │    ⋮            ⋮
 20996 │ 0.19532   Bayesian FM
 20997 │ 0.130483  Bayesian FM
 20998 │ 0.174461  Bayesian FM
 20999 │ 0.226412  Bayesian FM
 21000 │ 0.123783  Bayesian FM
                20989 rows omitted</code></pre><h4 id="Create-density-plot"><a class="docs-heading-anchor" href="#Create-density-plot">Create density plot</a><a id="Create-density-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Create-density-plot" title="Permalink"></a></h4><pre><code class="language-julia hljs">p1 = @df df density(:Value, group=:Method, 
    linewidth=2,
    xlabel=&quot;Risk premium (λstrong)&quot;,
    ylabel=&quot;Density&quot;,
    title=&quot;Strong Factor&quot;
)
vline!([lambda_ols[2]], linestyle=:dot, linewidth=1.5, color=:grey, label=&quot;&quot;)</code></pre><p><img src="../assets/FM_Strong.svg" alt="FM Strong Factor"/></p><h3 id="Case-2:-Useless-factor"><a class="docs-heading-anchor" href="#Case-2:-Useless-factor">Case 2: Useless factor</a><a id="Case-2:-Useless-factor-1"></a><a class="docs-heading-anchor-permalink" href="#Case-2:-Useless-factor" title="Permalink"></a></h3><h4 id="Repeat-the-process-with-useless-factor-(uf)"><a class="docs-heading-anchor" href="#Repeat-the-process-with-useless-factor-(uf)">Repeat the process with useless factor (uf)</a><a id="Repeat-the-process-with-useless-factor-(uf)-1"></a><a class="docs-heading-anchor-permalink" href="#Repeat-the-process-with-useless-factor-(uf)" title="Permalink"></a></h4><pre><code class="language-julia hljs">results_fm_uf = TwoPassRegression(uf, sim_R)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Two-Pass Regression Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000

OLS Risk Premia Estimates:
  λ_0: 0.1599 (SE: 0.0401, t: 3.99)
  λ_1: 0.9540 (SE: 0.3578, t: 2.67)

GLS Risk Premia Estimates:
  λ_0: 0.1057 (SE: 0.0362, t: 2.93)
  λ_1: -0.4335 (SE: 0.2760, t: -1.57)

Model Fit:
  Adjusted R² (OLS): -0.0075
  Adjusted R² (GLS): -0.0125
</code></pre><pre><code class="language-julia hljs">results_bfm_uf = BayesianFM(uf, sim_R, 2000)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Bayesian Fama-MacBeth Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 2000

Risk Premia Estimates (OLS):
  λ_0: 0.1510 (±0.0417)
  λ_1: 0.3079 (±0.9905)

Model Fit:
  Mean R² (OLS): 0.0842
  Mean R² (GLS): 0.0013</code></pre><pre><code class="language-julia hljs">m1_uf = results_fm_uf.lambda[k]
sd1_uf = sqrt(results_fm_uf.cov_lambda[k,k])
bfm_uf = results_bfm_uf.lambda_ols_path[1001:2000,k]
fm_uf = rand(rng, Normal(m1_uf, sd1_uf), 20000)
df_uf = DataFrame(
    Value = vcat(fm_uf, bfm_uf),
    Method = vcat(fill(&quot;Frequentist FM&quot;, 20000), fill(&quot;Bayesian FM&quot;, 1000))
)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">21000×2 DataFrame
   Row │ Value      Method
       │ Float64    String
───────┼───────────────────────────
     1 │  0.961224  Frequentist FM
     2 │  1.10149   Frequentist FM
     3 │  1.43786   Frequentist FM
     4 │  1.35079   Frequentist FM
     5 │  1.56759   Frequentist FM
     6 │  1.21512   Frequentist FM
   ⋮   │     ⋮            ⋮
 20996 │ -1.26963   Bayesian FM
 20997 │  0.669039  Bayesian FM
 20998 │ -0.802147  Bayesian FM
 20999 │  2.36535   Bayesian FM
 21000 │ -0.601039  Bayesian FM
                 20989 rows omitted</code></pre><pre><code class="language-julia hljs">p2 = @df df_uf density(:Value, group=:Method, 
    linewidth=2,
    xlabel=&quot;Risk premium (λspurious)&quot;,
    ylabel=&quot;Density&quot;,
    title=&quot;Useless Factor&quot;
)

vline!([lambda_ols[2]], linestyle=:dot, linewidth=1.5, color=:grey, label=&quot;&quot;)</code></pre><p><img src="../assets/FM_Spurious.svg" alt="FM Spurious Factor"/></p><h4 id="Display-plots-side-by-side"><a class="docs-heading-anchor" href="#Display-plots-side-by-side">Display plots side by side</a><a id="Display-plots-side-by-side-1"></a><a class="docs-heading-anchor-permalink" href="#Display-plots-side-by-side" title="Permalink"></a></h4><pre><code class="language-julia hljs">plot(p1, p2, layout=(1,2), size=(1200,400),bottom_margin=5Plots.mm)</code></pre><p><img src="../assets/FM_Both.svg" alt="FM Both"/></p><h2 id="Example-Bayesian-estimates-of-risk-prices-and-R2-(Bayesian-SDF)"><a class="docs-heading-anchor" href="#Example-Bayesian-estimates-of-risk-prices-and-R2-(Bayesian-SDF)">Example Bayesian estimates of risk prices and R2 (Bayesian SDF)</a><a id="Example-Bayesian-estimates-of-risk-prices-and-R2-(Bayesian-SDF)-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Bayesian-estimates-of-risk-prices-and-R2-(Bayesian-SDF)" title="Permalink"></a></h2><ul><li>Cross-section: Fama-French 25 size and value portfolios  </li><li>True pricing factor in simulations: HML  </li><li>Pseudo-true cross-sectional R-squared: 0.43  </li><li>Pseudo-true (monthly) risk price: 0.127  </li></ul><h3 id="Case-1:-Strong-factor-2"><a class="docs-heading-anchor" href="#Case-1:-Strong-factor-2">Case 1: Strong factor</a><a class="docs-heading-anchor-permalink" href="#Case-1:-Strong-factor-2" title="Permalink"></a></h3><h4 id="GMM-estimation"><a class="docs-heading-anchor" href="#GMM-estimation">GMM estimation</a><a id="GMM-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#GMM-estimation" title="Permalink"></a></h4><pre><code class="language-julia hljs">sim_result = SDF_gmm(sim_R, sim_f, W_ols)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">SDF GMM Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000

Risk Price Estimates:
  λ_0: 0.1672
  λ_1: 0.1666

Model Fit:
  Adjusted R²: 0.5804</code></pre><h4 id="Bayesian-estimation"><a class="docs-heading-anchor" href="#Bayesian-estimation">Bayesian estimation</a><a id="Bayesian-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-estimation" title="Permalink"></a></h4><pre><code class="language-julia hljs">two_step = BayesianSDF(sim_f, sim_R, 2000; psi0=5.0, d=0.5)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Bayesian SDF Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 2000
  Prior type: Flat
  Estimation type: OLS

Risk Price Estimates:
  λ_0: 0.1644 (±0.0291)
  λ_1: 0.1634 (±0.0353)

Model Fit:
  Mean R²: 0.5287 (±0.1228)</code></pre><h4 id="Extract-results-for-plotting-2"><a class="docs-heading-anchor" href="#Extract-results-for-plotting-2">Extract results for plotting</a><a class="docs-heading-anchor-permalink" href="#Extract-results-for-plotting-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">k = 2  # lambda of the strong factor
m1 = sim_result.lambda_gmm[k]
sd1 = sqrt(sim_result.Avar_hat[k,k])

# Get posterior draws
bfm = two_step.lambda_path[1001:2000, k]

# Generate GMM draws
rng = MersenneTwister(123)  # for reproducibility
fm = rand(rng, Normal(m1, sd1), 5000)

# Create plotting DataFrame for strong factor
df_strong = DataFrame(
    Value = vcat(fm, bfm),
    Method = vcat(fill(&quot;GMM-OLS&quot;, 5000), fill(&quot;BSDF-OLS&quot;, 1000))
)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">6000×2 DataFrame
  Row │ Value     Method   
      │ Float64   String
──────┼────────────────────
    1 │ 0.208319  GMM-OLS
    2 │ 0.238374  GMM-OLS
    3 │ 0.20665   GMM-OLS
    4 │ 0.182714  GMM-OLS
    5 │ 0.152722  GMM-OLS
    6 │ 0.143332  GMM-OLS
  ⋮   │    ⋮         ⋮
 5996 │ 0.192677  BSDF-OLS
 5997 │ 0.118785  BSDF-OLS
 5998 │ 0.173055  BSDF-OLS
 5999 │ 0.218479  BSDF-OLS
 6000 │ 0.125678  BSDF-OLS
          5989 rows omitted</code></pre><h4 id="Create-density-plot-for-strong-factor"><a class="docs-heading-anchor" href="#Create-density-plot-for-strong-factor">Create density plot for strong factor</a><a id="Create-density-plot-for-strong-factor-1"></a><a class="docs-heading-anchor-permalink" href="#Create-density-plot-for-strong-factor" title="Permalink"></a></h4><pre><code class="language-julia hljs">p1 = @df df_strong density(:Value, group=:Method, 
    linewidth=2,
    xlabel=&quot;Risk price (λstrong)&quot;,
    ylabel=&quot;Density&quot;,
    title=&quot;Strong Factor&quot;,
    adjust=1
)

vline!([lambda_ols[2]], linestyle=:dot, linewidth=1.5, color=:grey, label=&quot;&quot;)</code></pre><p><img src="../assets/SDF_Strong.svg" alt="SDF Strong Factor"/></p><h3 id="Case-2:-Useless-factor-2"><a class="docs-heading-anchor" href="#Case-2:-Useless-factor-2">Case 2: Useless factor</a><a class="docs-heading-anchor-permalink" href="#Case-2:-Useless-factor-2" title="Permalink"></a></h3><h4 id="GMM-estimation-2"><a class="docs-heading-anchor" href="#GMM-estimation-2">GMM estimation</a><a class="docs-heading-anchor-permalink" href="#GMM-estimation-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">sim_result_uf = SDF_gmm(sim_R, uf, W_ols)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">SDF GMM Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000

Risk Price Estimates:
  λ_0: 0.1599
  λ_1: 0.9540

Model Fit:
  Adjusted R²: -0.0075</code></pre><h4 id="Bayesian-estimation-2"><a class="docs-heading-anchor" href="#Bayesian-estimation-2">Bayesian estimation</a><a class="docs-heading-anchor-permalink" href="#Bayesian-estimation-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">two_step_uf = BayesianSDF(uf, sim_R, 2000; psi0=5.0, d=0.5)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Bayesian SDF Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 2000
  Prior type: Flat
  Estimation type: OLS

Risk Price Estimates:
  λ_0: 0.1490 (±0.0413)
  λ_1: 0.3065 (±0.9778)

Model Fit:
  Mean R²: 0.0837 (±0.1400)</code></pre><h4 id="Extract-results"><a class="docs-heading-anchor" href="#Extract-results">Extract results</a><a id="Extract-results-1"></a><a class="docs-heading-anchor-permalink" href="#Extract-results" title="Permalink"></a></h4><pre><code class="language-julia hljs">m1_uf = sim_result_uf.lambda_gmm[k]
sd1_uf = sqrt(sim_result_uf.Avar_hat[k,k])
bfm_uf = two_step_uf.lambda_path[1001:2000, k]
fm_uf = rand(rng, Normal(m1_uf, sd1_uf), 5000)

# Create plotting DataFrame for useless factor
df_useless = DataFrame(
    Value = vcat(fm_uf, bfm_uf),
    Method = vcat(fill(&quot;GMM-OLS&quot;, 5000), fill(&quot;BSDF-OLS&quot;, 1000))
)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">6000×2 DataFrame
  Row │ Value      Method   
      │ Float64    String
──────┼─────────────────────
    1 │  0.564754  GMM-OLS
    2 │  1.16776   GMM-OLS
    3 │  1.38975   GMM-OLS
    4 │  0.842655  GMM-OLS
    5 │  0.901772  GMM-OLS
    6 │  0.800888  GMM-OLS
  ⋮   │     ⋮         ⋮
 5996 │ -1.22358   BSDF-OLS
 5997 │  0.646415  BSDF-OLS
 5998 │ -0.808775  BSDF-OLS
 5999 │  2.24012   BSDF-OLS
 6000 │ -0.642434  BSDF-OLS
           5989 rows omitted</code></pre><h4 id="Create-density-plot-for-useless-factor"><a class="docs-heading-anchor" href="#Create-density-plot-for-useless-factor">Create density plot for useless factor</a><a id="Create-density-plot-for-useless-factor-1"></a><a class="docs-heading-anchor-permalink" href="#Create-density-plot-for-useless-factor" title="Permalink"></a></h4><pre><code class="language-julia hljs">p2 = @df df_useless density(:Value, group=:Method, 
    linewidth=2,
    xlabel=&quot;Risk price (λspurious)&quot;,
    ylabel=&quot;Density&quot;,
    title=&quot;Useless Factor&quot;,
    adjust=2  # Note different adjustment for useless factor plot
)
vline!([0.0], linestyle=:dot, linewidth=1.5, color=:grey, label=&quot;&quot;)</code></pre><p><img src="../assets/SDF_Spurious.svg" alt="SDF Spurious Factor"/></p><h4 id="Display-plots-side-by-side-2"><a class="docs-heading-anchor" href="#Display-plots-side-by-side-2">Display plots side by side</a><a class="docs-heading-anchor-permalink" href="#Display-plots-side-by-side-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">plot(p1, p2, layout=(1,2), size=(1200,500),bottom_margin=5Plots.mm)</code></pre><p><img src="../assets/SDF_Both.svg" alt="SDF Both"/></p><h2 id="Example-Continuous-SS-SDF"><a class="docs-heading-anchor" href="#Example-Continuous-SS-SDF">Example Continuous SS SDF</a><a id="Example-Continuous-SS-SDF-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Continuous-SS-SDF" title="Permalink"></a></h2><h4 id="Combine-factors-sim_f-and-uf"><a class="docs-heading-anchor" href="#Combine-factors-sim_f-and-uf">Combine factors sim_f and uf</a><a id="Combine-factors-sim_f-and-uf-1"></a><a class="docs-heading-anchor-permalink" href="#Combine-factors-sim_f-and-uf" title="Permalink"></a></h4><pre><code class="language-julia hljs">combined_factors = hcat(sim_f, uf);</code></pre><h4 id="Calculate-prior-SR-to-get-psi"><a class="docs-heading-anchor" href="#Calculate-prior-SR-to-get-psi">Calculate prior SR to get psi</a><a id="Calculate-prior-SR-to-get-psi-1"></a><a class="docs-heading-anchor-permalink" href="#Calculate-prior-SR-to-get-psi" title="Permalink"></a></h4><pre><code class="language-julia hljs">psi_hat = psi_to_priorSR(sim_R, combined_factors; priorSR=0.1);</code></pre><h3 id="Run-continuous-spike-and-slab-SDF-estimation"><a class="docs-heading-anchor" href="#Run-continuous-spike-and-slab-SDF-estimation">Run continuous spike-and-slab SDF estimation</a><a id="Run-continuous-spike-and-slab-SDF-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Run-continuous-spike-and-slab-SDF-estimation" title="Permalink"></a></h3><pre><code class="language-julia hljs">shrinkage = continuous_ss_sdf(combined_factors, sim_R, 5000;
                            psi0=psi_hat, 
                            r=0.001, 
                            aw=1.0, 
                            bw=1.0)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Continuous Spike-and-Slab SDF Results:
--------------------------------
Model Information:
  Number of factors: 2
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 5000

Factor Inclusion Probabilities:
  Factor 1: 0.9348
  Factor 2: 0.5026

Risk Price Estimates:
  λ_0: 0.1586 (±0.0303)
  λ_1: 0.1024 (±0.0451)
  λ_2: -0.0000 (±0.0016)</code></pre><p>Null hypothesis: lambda = 0 for each factor Posterior probabilities of rejecting the above null hypotheses are: [0.9348 0.5026]</p><h3 id="Get-SDF-paths"><a class="docs-heading-anchor" href="#Get-SDF-paths">Get SDF paths</a><a id="Get-SDF-paths-1"></a><a class="docs-heading-anchor-permalink" href="#Get-SDF-paths" title="Permalink"></a></h3><pre><code class="language-julia hljs">shrinkage.sdf_path</code></pre><h3 id="Get-BMA-SDF"><a class="docs-heading-anchor" href="#Get-BMA-SDF">Get BMA-SDF</a><a id="Get-BMA-SDF-1"></a><a class="docs-heading-anchor-permalink" href="#Get-BMA-SDF" title="Permalink"></a></h3><pre><code class="language-julia hljs">shrinkage.bma_sdf</code></pre><h2 id="Example-Continuous-SS-SDF-v2-(tradable-factors)"><a class="docs-heading-anchor" href="#Example-Continuous-SS-SDF-v2-(tradable-factors)">Example Continuous SS SDF v2 (tradable factors)</a><a id="Example-Continuous-SS-SDF-v2-(tradable-factors)-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Continuous-SS-SDF-v2-(tradable-factors)" title="Permalink"></a></h2><h3 id="Example-1:-Using-first-test-asset"><a class="docs-heading-anchor" href="#Example-1:-Using-first-test-asset">Example 1: Using first test asset</a><a id="Example-1:-Using-first-test-asset-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-Using-first-test-asset" title="Permalink"></a></h3><h4 id="Combine-factors-and-first-test-asset-for-psi-calculation"><a class="docs-heading-anchor" href="#Combine-factors-and-first-test-asset-for-psi-calculation">Combine factors and first test asset for psi calculation</a><a id="Combine-factors-and-first-test-asset-for-psi-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Combine-factors-and-first-test-asset-for-psi-calculation" title="Permalink"></a></h4><pre><code class="language-julia hljs">combined_factors_1 = hcat(sim_f, uf, sim_R[:,1]);</code></pre><h4 id="Calculate-psi_hat"><a class="docs-heading-anchor" href="#Calculate-psi_hat">Calculate psi_hat</a><a id="Calculate-psi_hat-1"></a><a class="docs-heading-anchor-permalink" href="#Calculate-psi_hat" title="Permalink"></a></h4><pre><code class="language-julia hljs">psi_hat = psi_to_priorSR(sim_R, combined_factors_1; priorSR=0.1);</code></pre><h4 id="Prepare-inputs-for-continuous*ss*sdf_v2"><a class="docs-heading-anchor" href="#Prepare-inputs-for-continuous*ss*sdf_v2">Prepare inputs for continuous<em>ss</em>sdf_v2</a><a id="Prepare-inputs-for-continuous*ss*sdf_v2-1"></a><a class="docs-heading-anchor-permalink" href="#Prepare-inputs-for-continuous*ss*sdf_v2" title="Permalink"></a></h4><pre><code class="language-julia hljs">f1 = hcat(sim_f, uf);          # non-tradable factors
f2 = sim_R[:,1:1];             # tradable factor (first test asset)
R_reduced = sim_R[:,2:end];    # remaining test assets</code></pre><h4 id="Run-continuous-spike-and-slab-SDF-v2"><a class="docs-heading-anchor" href="#Run-continuous-spike-and-slab-SDF-v2">Run continuous spike-and-slab SDF v2</a><a id="Run-continuous-spike-and-slab-SDF-v2-1"></a><a class="docs-heading-anchor-permalink" href="#Run-continuous-spike-and-slab-SDF-v2" title="Permalink"></a></h4><pre><code class="language-julia hljs">shrinkage = continuous_ss_sdf_v2(f1, f2, R_reduced, 1000;
                                psi0=psi_hat,
                                r=0.001,
                                aw=1.0,
                                bw=1.0)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Continuous Spike-and-Slab SDF Results:
--------------------------------
Model Information:
  Number of factors: 3
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 1000

Factor Inclusion Probabilities:
  Factor 1: 0.9240
  Factor 2: 0.3820
  Factor 3: 0.6680

Risk Price Estimates:
  λ_0: 0.1643 (±0.0344)
  λ_1: 0.0881 (±0.0423)
  λ_2: 0.0000 (±0.0013)
  λ_3: -0.0077 (±0.0241)</code></pre><p>Null hypothesis: lambda = 0 for each of these three factors   Posterior probabilities of rejecting the above null hypotheses are: [0.924 0.382 0.668]  </p><h4 id="Calculate-model-implied-Sharpe-ratios"><a class="docs-heading-anchor" href="#Calculate-model-implied-Sharpe-ratios">Calculate model-implied Sharpe ratios</a><a id="Calculate-model-implied-Sharpe-ratios-1"></a><a class="docs-heading-anchor-permalink" href="#Calculate-model-implied-Sharpe-ratios" title="Permalink"></a></h4><pre><code class="language-julia hljs">sr_quantiles = quantile(std(shrinkage.sdf_path, dims=2), [0.05, 0.5, 0.95])
println(&quot;The 5th, 50th, and 95th quantiles of model-implied Sharpe ratios: &quot;, round.(sr_quantiles,digits=4))</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">The 5th, 50th, and 95th quantiles of model-implied Sharpe ratios: [0.0267, 0.1092, 0.1723]</code></pre><h4 id="Calculate-posterior-distribution-of-model-dimensions"><a class="docs-heading-anchor" href="#Calculate-posterior-distribution-of-model-dimensions">Calculate posterior distribution of model dimensions</a><a id="Calculate-posterior-distribution-of-model-dimensions-1"></a><a class="docs-heading-anchor-permalink" href="#Calculate-posterior-distribution-of-model-dimensions" title="Permalink"></a></h4><pre><code class="language-julia hljs">model_dims = sum(shrinkage.gamma_path, dims=2)
dim_counts = counts(Int.(vec(model_dims)), 0:3)  # count occurrences of 0,1,2,3
dim_props = dim_counts / sum(dim_counts)
println(&quot;The posterior distribution of model dimensions (= 0, 1, 2, 3): &quot;, dim_props)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">The posterior distribution of model dimensions (= 0, 1, 2, 3): [0.015, 0.214, 0.553, 0.218]</code></pre><h4 id="Optional:-Visualize-results"><a class="docs-heading-anchor" href="#Optional:-Visualize-results">Optional: Visualize results</a><a id="Optional:-Visualize-results-1"></a><a class="docs-heading-anchor-permalink" href="#Optional:-Visualize-results" title="Permalink"></a></h4><h5 id="Plot-posterior-distribution-of-model-dimensions"><a class="docs-heading-anchor" href="#Plot-posterior-distribution-of-model-dimensions">Plot posterior distribution of model dimensions</a><a id="Plot-posterior-distribution-of-model-dimensions-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-posterior-distribution-of-model-dimensions" title="Permalink"></a></h5><pre><code class="language-julia hljs">p1 = bar(0:3, dim_props,
    xlabel=&quot;Model Dimension&quot;,
    ylabel=&quot;Probability&quot;,
    title=&quot;Posterior Distribution of Model Dimensions&quot;,
    label=&quot;&quot;)</code></pre><p><img src="../assets/c_ss_sdf_v2_mdim.svg" alt="Model Dimension"/></p><h5 id="Plot-SDF-paths"><a class="docs-heading-anchor" href="#Plot-SDF-paths">Plot SDF paths</a><a id="Plot-SDF-paths-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-SDF-paths" title="Permalink"></a></h5><pre><code class="language-julia hljs">p2 = plot(1:size(shrinkage.sdf_path,2), shrinkage.bma_sdf,
    label=&quot;BMA-SDF&quot;,
    linewidth=2,
    color=:black,
    title=&quot;SDF Paths and BMA-SDF&quot;);</code></pre><p><img src="../assets/c_ss_sdf_v2_bmasdf.svg" alt="BMA-SDF"/></p><h5 id="Add-sample-paths"><a class="docs-heading-anchor" href="#Add-sample-paths">Add sample paths</a><a id="Add-sample-paths-1"></a><a class="docs-heading-anchor-permalink" href="#Add-sample-paths" title="Permalink"></a></h5><pre><code class="language-julia hljs">function add_sample_paths!(p, shrinkage, n)
    for i in 1:min(n, size(shrinkage.sdf_path,1))
        plot!(p, 1:size(shrinkage.sdf_path,2), shrinkage.sdf_path[i,:],
            alpha=0.1,
            color=:blue,
            label=&quot;&quot;)
    end
end
add_sample_paths!(p2,shrinkage,50)
plot(p1, p2, layout=(1,2), size=(1200,400))</code></pre><p><img src="../assets/c_ss_sdf_v2_both.svg" alt="Model Dimension BMA-SDF Path and Sample Paths"/></p><h2 id="Example-Bayesian-p-value-(dirac*ss*sdf_pvalue)"><a class="docs-heading-anchor" href="#Example-Bayesian-p-value-(dirac*ss*sdf_pvalue)">Example Bayesian p-value (dirac<em>ss</em>sdf_pvalue)</a><a id="Example-Bayesian-p-value-(dirac*ss*sdf_pvalue)-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Bayesian-p-value-(dirac*ss*sdf_pvalue)" title="Permalink"></a></h2><h4 id="Choose-psi-based-on-prior-Sharpe-ratio"><a class="docs-heading-anchor" href="#Choose-psi-based-on-prior-Sharpe-ratio">Choose psi based on prior Sharpe ratio</a><a id="Choose-psi-based-on-prior-Sharpe-ratio-1"></a><a class="docs-heading-anchor-permalink" href="#Choose-psi-based-on-prior-Sharpe-ratio" title="Permalink"></a></h4><pre><code class="language-julia hljs">round4(x) = round(x,digits=4);
println(&quot;If psi = 1, prior Sharpe ratio is &quot;, 
        psi_to_priorSR(sim_R, sim_f; psi0=1.0) |&gt; round4)
println(&quot;If psi = 2, prior Sharpe ratio is &quot;, 
        psi_to_priorSR(sim_R, sim_f; psi0=2.0) |&gt; round4)
println(&quot;If psi = 5, prior Sharpe ratio is &quot;, 
        psi_to_priorSR(sim_R, sim_f; psi0=5.0) |&gt; round4)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">If psi = 1, prior Sharpe ratio is 0.0724
If psi = 2, prior Sharpe ratio is 0.1014
If psi = 5, prior Sharpe ratio is 0.1559</code></pre><h4 id="Test-whether-factors&#39;-risk-prices-equal-lambda_ols[2]*std(HML)"><a class="docs-heading-anchor" href="#Test-whether-factors&#39;-risk-prices-equal-lambda_ols[2]*std(HML)">Test whether factors&#39; risk prices equal lambda_ols[2]*std(HML)</a><a id="Test-whether-factors&#39;-risk-prices-equal-lambda_ols[2]*std(HML)-1"></a><a class="docs-heading-anchor-permalink" href="#Test-whether-factors&#39;-risk-prices-equal-lambda_ols[2]*std(HML)" title="Permalink"></a></h4><pre><code class="language-julia hljs">lambda0 = reshape([lambda_ols[2] * std(HML)], :, 1);
shrinkage = dirac_ss_sdf_pvalue(sim_f, sim_R, 1000, vec(lambda0))</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Dirac Spike-and-Slab SDF Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 1000

Factor Inclusion Probabilities:
  Factor 1: 0.0150

Risk Price Estimates:
  λ_0: 0.1603 (±0.0293)
  λ_1: 0.1256 (±0.0106)</code></pre><p>Null hypothesis: lambda = 0.1269 Posterior probability of rejecting the above null hypothesis is: 0.015</p><h4 id="Test-whether-the-risk-price-of-factor-&#39;sim_f&#39;-is-equal-to-0"><a class="docs-heading-anchor" href="#Test-whether-the-risk-price-of-factor-&#39;sim_f&#39;-is-equal-to-0">Test whether the risk price of factor &#39;sim_f&#39; is equal to 0</a><a id="Test-whether-the-risk-price-of-factor-&#39;sim_f&#39;-is-equal-to-0-1"></a><a class="docs-heading-anchor-permalink" href="#Test-whether-the-risk-price-of-factor-&#39;sim_f&#39;-is-equal-to-0" title="Permalink"></a></h4><pre><code class="language-julia hljs">shrinkage = dirac_ss_sdf_pvalue(sim_f, sim_R, 1000, [0.0]; psi0=1.0)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Dirac Spike-and-Slab SDF Results:
--------------------------------
Model Information:
  Number of factors: 1
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 1000

Factor Inclusion Probabilities:
  Factor 1: 0.9510

Risk Price Estimates:
  λ_0: 0.1557 (±0.0295)
  λ_1: 0.0787 (±0.0345)</code></pre><p>Null hypothesis: lambda = 0 Posterior probability of rejecting the above null hypothesis is: 0.951</p><h3 id="Test-multiple-factors"><a class="docs-heading-anchor" href="#Test-multiple-factors">Test multiple factors</a><a id="Test-multiple-factors-1"></a><a class="docs-heading-anchor-permalink" href="#Test-multiple-factors" title="Permalink"></a></h3><h4 id="Combine-strong-and-useless-factors"><a class="docs-heading-anchor" href="#Combine-strong-and-useless-factors">Combine strong and useless factors</a><a id="Combine-strong-and-useless-factors-1"></a><a class="docs-heading-anchor-permalink" href="#Combine-strong-and-useless-factors" title="Permalink"></a></h4><pre><code class="language-julia hljs">two_f = hcat(sim_f, uf);</code></pre><h4 id="Test-both-factors&#39;-risk-prices-equal-to-zero"><a class="docs-heading-anchor" href="#Test-both-factors&#39;-risk-prices-equal-to-zero">Test both factors&#39; risk prices equal to zero</a><a id="Test-both-factors&#39;-risk-prices-equal-to-zero-1"></a><a class="docs-heading-anchor-permalink" href="#Test-both-factors&#39;-risk-prices-equal-to-zero" title="Permalink"></a></h4><pre><code class="language-julia hljs">lambda0_null_vec = zeros(2);  # 2x1 vector
shrinkage = dirac_ss_sdf_pvalue(two_f, sim_R, 1000, lambda0_null_vec; psi0=1.0)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Dirac Spike-and-Slab SDF Results:
--------------------------------
Model Information:
  Number of factors: 2
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 1000

Factor Inclusion Probabilities:
  Factor 1: 0.9640
  Factor 2: 0.5040

Risk Price Estimates:
  λ_0: 0.1577 (±0.0302)
  λ_1: 0.0796 (±0.0338)
  λ_2: -0.0000 (±0.0010)</code></pre><p>Null hypothesis: lambda = 0 for each factor Posterior probabilities of rejecting the above null hypothesis are 0.964 and 0.504</p><h4 id="Print-posterior-model-probabilities"><a class="docs-heading-anchor" href="#Print-posterior-model-probabilities">Print posterior model probabilities</a><a id="Print-posterior-model-probabilities-1"></a><a class="docs-heading-anchor-permalink" href="#Print-posterior-model-probabilities" title="Permalink"></a></h4><pre><code class="language-julia hljs">println(&quot;\nPosterior model probabilities are:&quot;)
display(shrinkage.model_probs)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Posterior model probabilities are:
4×3 Matrix{Float64}:
 0.0  0.0  0.019
 1.0  0.0  0.477
 0.0  1.0  0.017
 1.0  1.0  0.487</code></pre><h3 id="Test-with-maximum-number-of-factors-restriction"><a class="docs-heading-anchor" href="#Test-with-maximum-number-of-factors-restriction">Test with maximum number of factors restriction</a><a id="Test-with-maximum-number-of-factors-restriction-1"></a><a class="docs-heading-anchor-permalink" href="#Test-with-maximum-number-of-factors-restriction" title="Permalink"></a></h3><pre><code class="language-julia hljs">shrinkage = dirac_ss_sdf_pvalue(two_f, sim_R, 1000, lambda0_null_vec; 
                               psi0=1.0, max_k=1)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Dirac Spike-and-Slab SDF Results:
--------------------------------
Model Information:
  Number of factors: 2
  Number of assets: 25
  Time periods: 1000
  MCMC iterations: 1000

Factor Inclusion Probabilities:
  Factor 1: 0.9290
  Factor 2: 0.0340

Risk Price Estimates:
  λ_0: 0.1574 (±0.0302)
  λ_1: 0.0773 (±0.0360)
  λ_2: 0.0000 (±0.0003)</code></pre><pre><code class="language-julia hljs">println(&quot;\nPosterior model probabilities with max_k=1 are:&quot;)
display(shrinkage.model_probs)</code></pre><p>Console Output:</p><pre><code class="language-julia hljs">Posterior model probabilities with max_k=1 are:
3×3 Matrix{Float64}:
 0.0  0.0  0.037
 1.0  0.0  0.929
 0.0  1.0  0.034</code></pre><h3 id="Visualize-posterior-probabilities"><a class="docs-heading-anchor" href="#Visualize-posterior-probabilities">Visualize posterior probabilities</a><a id="Visualize-posterior-probabilities-1"></a><a class="docs-heading-anchor-permalink" href="#Visualize-posterior-probabilities" title="Permalink"></a></h3><h4 id="Plot-posterior-probabilities-for-each-factor"><a class="docs-heading-anchor" href="#Plot-posterior-probabilities-for-each-factor">Plot posterior probabilities for each factor</a><a id="Plot-posterior-probabilities-for-each-factor-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-posterior-probabilities-for-each-factor" title="Permalink"></a></h4><pre><code class="language-julia hljs">p1 = bar(mean(shrinkage.gamma_path, dims=1)&#39;,
    title=&quot;Factor Inclusion Probabilities&quot;,
    xlabel=&quot;Factor&quot;,
    ylabel=&quot;Probability&quot;,
    label=&quot;&quot;,
    xticks=(1:2, [&quot;Strong&quot;, &quot;Useless&quot;]))</code></pre><p><img src="../assets/pvalue_inc_prob.svg" alt="Factor Inclusion Probabilities"/></p><h4 id="Plot-model-probabilities"><a class="docs-heading-anchor" href="#Plot-model-probabilities">Plot model probabilities</a><a id="Plot-model-probabilities-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-model-probabilities" title="Permalink"></a></h4><pre><code class="language-julia hljs">p2 = bar(shrinkage.model_probs[:,end],
    title=&quot;Model Posterior Probabilities&quot;,
    xlabel=&quot;Model Index&quot;,
    ylabel=&quot;Probability&quot;,
    label=&quot;&quot;)
plot(p1, p2, layout=(1,2), size=(1200,400),bottom_margin=5Plots.mm)</code></pre><p><img src="../assets/pvalue_inc_prob_model_post_prob.svg" alt="Inc Prob and Model Post. Prob."/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../api/core/">Core Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 12 December 2024 12:29">Thursday 12 December 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
